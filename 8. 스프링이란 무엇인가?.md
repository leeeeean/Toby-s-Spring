# 8. 스프링이란 무엇인가?



## 8.1 스프링의 정의

> ###### 자바 엔터프라이즈 개발을 편하게 해주는 오픈소스 경량급 애플리케이션 프레임워크

#### 애플리케이션 프레임워크

* 일반적으로 프레임워크는 애플리케이션의 특정 계층에서 
  주로 동작하는 한 가지 기술 분야에 집중한다
* 애플리케이션 프레임워크는 좀 다르다
  * 특정 계층이나, 기술, 업무 분야에 국한되지 않고 
    애플리케이션 전 영역을 포괄하는 범용적인 프레임워크를 뜻한다.
  * 애플리케이션 개발의 전 과정을 빠르고 편리하며 효율적으로 진행하는데 일차적인 목표를 둔다
  * 애플리케이션의 전 영역을 관통하는 일관된 프로그래밍 모델과 
    핵심 기술을 바탕으로 해서 각 분야의 특성에 맞는필요를 채워주고 있다
* 스프링의 존재 목적
  * 핵심 기술에 담긴 프로그래밍 모델을 일관되게 적용해서
    엔터프라이즈 애플리케이션 전 계층과 전 영역에 전략과 기능을 제공해줌으로써 
    애플리케이선을 편리하게 개발하게 해주는 애플리케이션 프레임워크

#### 경량급

* 불필요하게 무겁지 않음
* 가장 단순한 서버 환경인 톰캣이나 제타에서도 완벽하게 동작한다
  EJB 컨테이너를 비롯해 복잡한 기능이 잔뜩 포함된 WAS를 굳이 사용하지 않아도 된다

#### 자바 엔터프라이즈 개발을 편하게

* 근본적인 부분에서 엔터프라이즈 개발의 복잡함을 제거해내고 
  진정으로 개발을 편하게 해주는 해결책을 제시한다
* 엔터프라이즈 개발의 기술적인 복잡함과 그에 따른 수고를 제거해준다
  * 필연적으로 요구되는 기술적인 요구를 충족하면서도 개발을 복잡하게 만들지 않는다는 점이다

#### 오픈소스

* 오픈소스란 소스가 모두에게 공개되고, 특별한 라이선스를 취득할 필요없이 
  얼마든지 가져다 자유롭게 이용해도 된다는 뜻이다
  * 소스를 자유롭게 열람 가능
  * 얼마든지 가져다 자유롭게 이용 가능
  * 수정 가능
  * 수정된 제품과 소스를 다시 공개적으로 배포 가능
* 아파치 라이선스 2.0
  * 상업적 사용 및 비공개 사용 가능
  * 스프링을 사용한다고 적시, 원 저작자 공개
* 장점
  * 투명한 방식으로 참여를 통한 개발
  * 빠르고 유연한 개발
  * 버그 신고
  * 기능 개산 제안
  * 다양한 자발적 사용, 이를 통한 버그 발견 및 문제점 발견 및 빠른 해결
* 단점
  * 지속적이고 안정적인 개빌이 계속될지 불확실
* 그래서 스프링은?
  * 개빌을 책임질 전문 기업을 만듬

## 8.2 스프링의 목적

??? 스프링 적용 베스트 프렉티스를 보고 따라해도, 그 기능과 API를 잘안다고 해도 잘 쓰는게 아니래.. ???

" 스프링의 목적을 바로 이해하고, 그 목적을  이루는 도구로 스프링을 
잘 활용해야만 제대로 된 가치를 얻을 수 있다 "

### 엔터프라이즈 개발의 복잡함

> 자바 엔터프라이즈 프로젝트는 왜 실패하는가?

#### 복잡함의 근본적인 이유

1. 기술적인 제약조건과 요구사항이 늘어가기 떄문이다
   * 많은 사용자의 요청을 동시에 처리해야 함
   * 보안과 안정성, 확장성 면에서도 뛰어나야 함
   * 시스템 설계자와 개발자 개개인이 져야 할 기술적인 부담이 커져감
2. 엔터프라이즈 애플리케이션이 구현해야할 
   핵심기능인 비즈니스 로직의 복잡함이 증가하기 때문이다
   * 엔터프라이즈 시스템을 이용해 기업의 핵심 업무를 처리하는 비율이 늘어감
   * 업무 처리가 엔터프라이즈 시스템에 의존함

* 경제 흐름과 사회의 변회 업계의 추이에 따라서 수시로 업무 프로세스를 변경하고 
  조종하는 것을 상시화할 만큼 변화의 속도가 빨라짐
* 그래서 시스템 개발과 유지보수, 추가개발 등의 작업에 대한 부담이 커지는 중

#### 복잡함을 가중시키는 원인

* 비즈니스 로직과 엔터프라이즈 기술이라는 두 가지 복잡함이 한데 얽혀 있기 때문
  이 두 가지를 한번에 다뤄야 하니 복잡함이 몇배로 가중됨

### 복잡함을 해결하려는 도전

#### 제거될 수 없는 근본적인 복잡함

* 복잡함은 제거할 수 없음
  복잡함을 효과적으로 상대할 수 있는 전략과 기법이 필요함
* 비즈니스 로직을 다루는 방법괴 기술적인 복잡함을 다루기 위한 방법이 다른게 문제

#### 실패한 해결책: EJB

* 애플리케이션 로직을 담은 핵심 코드에서 일부 기술적인 코드가 제거된 건 사실이지만, 
  오히려 EJB라는 환경과 스펙에 종속되는 코드로 만들어져야 하는 더 큰 부담을 안게 됬다
* 복잡함을 덜어주려다 오히려 더 큰 복잡함을 추가함

#### 비침투적인 방식을 통한 효과적인 해결책: 스프링

* 침투적인 : 기술을 적용했을 때 그 기술과 관련되 코드나 규약 등이 코드에 들언나는 경우
* 비침투적인 : 기술의 적용 사실이 코드에 직접 반영되지 않음
  * 코드의 설계와 구현 방식을 제한하지 않음
* 스프링은 비침투적 기술
  * 기술적인 복잡함과 비즈니스 로직을 다루는 코드를 깔끔하게 분리 가능
  * 스프링 스스로가 애플리케이션 코드에 불필요하게 나타나지 않아야 함
* 스프링은 성공함

### 복잡함을 상대하는 스프링의 전략

#### 기술적 복잡함을 상대하는 전략

* 첫번째 문제: 기술에 대한 접근 방식이 일관성이 없고, 특정 환경에 종속적이다
  * 해결방법
    * 서비스 추상화 
      테스트의 편의성을 증대시키고 기술에 대힌 세부 설정과 환경으로부터 독립적인 코드를 만들 수 있다
    * 데이터 액세스 예외 추상화
    * 템플릿/콜백 패턴
* 두번째 문제: 기술적인 처리를 담당하는 코드가 성격이 다른 코드에 섞여서 등장한다
  * 예시
    * 트랜젝션
    * 보안 적용
    * 로깅
  * 해결방법
  * AOP

#### 비즈니스와 애플리케이션 로직의 복잡함을 상대하는 전략

다 제거하면 복잡한 비즈니스 로직만 남는다

* 비즈니스 로직이 가장 중요한 부분이다
* 하지만 자바라는 객체지향 언어의 장점을 잘 살려 비즈니스 로직의 복잡함을 최대한 효과적으로 다룰 수 있는 깔끔한 코드를 만드는 건 어렵지 않다
* 전략이 바로 자바라는 객체지향 기술 그 자체디 (허무;)]

#### 핵심 도구: 객체지향과 DI

기술적인 복잡함을 효과적으로 다루게 해주는 기법은 모두 DI를 바탕으로 하고 있음

* 서비스 추상화
* 템플릿/콜백
* AOP

DI는 객체지향 설계기술 없이는 그 존재의미가 없다

* DI를 열심히 적용하다 보면 객체지향 설계의 원칙을 잘 따르고 그 장점을 살린 설계가 나올 수 있다

> ###### 모든 스프링의 기술과 전략은 객체지향이라는 자바 언어가 가진 강력한 도구를 극대화해서 
>
> ###### 사용할 수 있도록 돕는 것

## 8.3 POJO 프로그래밍

> ###### 스프링의 가장 강력한 특징과 목표
>
> 분리됐지만 반드시 필요한 엔터프라이즈 서비스 기술을 POJO 방식으로
> 개발된 애플리케이션 핵심 로직을 담은 코드에 제공한다

### 스프링의 핵심: POJO

스프링 애플리케이션 : POJO를 이용해서 만든 애플리케이션 코드와 
POJO가 어떻게 관계를 맺고 동작하는지를 정의해놓은 설계정보로 구분된다

DI의 기본 아이디어 : 유연하게 확장 가능한 오브젝트를 만들어두고 그 관계는 외부에서 다이내믹하게 설정해준다는 것

스프링 프레임워크 : DI의 개념을 애플리케이션 전반에 걸쳐 적용하는 것

* ###### IoC/DI, AOP, PSA는 애플리케이션을 POJO로 개발할 수 있게 해주는 가능기술 이라고 불린다

### POJO란 무엇인가?

> ###### Plain Old Java Object

== 간단한 자바 오브젝트를 사용하는데요

### POJO의 조건

* ##### 특정 규약에 종속되지 않는다

  ###### 특정 규약에 종속되는 경우

  * 특정 규약을 따라 만들게 하는경우는 대부분 규약에서 제시하는 특정 클래스를 상속하도록 요구한다
  * 그럴 경우 단일 상속 제한 떄문에 해당 클래스에 객체지향적인 설계 기법을 적용하기 어렵다
  * 규약이 적용된 환경에 종속적이 되기 때문에 다른 환경으로 이전이 힘들다

  ##### 규약에 종속되지 않고, 객체지향 설계의 자유로운 적용이 가능한 오브젝트여야만 POJO라고 불릴 수 있다

* ##### 특정 환경에 종속되지 않는다

  예시

  * EJB 3 처럼 JDNI왁 같은 특정 환경이 의존 대상 검색 방식에 종속적이라면 POJO라고 할 수 없다
  * 순수한 애플리케이션 로직을 담고 있는 오브젝트 코드가 
    특정 환경에 종속되게 만드는 경우라면 POJO라고 할 수 없다
  * POJO 클래스는 웹이라는 환경정보나 웹 기술을 담고 있는 클래스나 인터페이스를 사용해서는 안 된다
  * 애노태이션이나 엘리먼트 값에 특정 기술과 환경에 
    종속적인 정보를 담고 있다면 그때는 POJO로서 가치를 잃는다
  * 특정 기술과 환경에 종속적이지 않다고 해서 POJO가 아니다
    * 자바 문법을 사용한다고 POJO가 되지 않음
    * 객체지향 프로그래밍이 중요

##### 진정한 POJO란 객체 지향적인 원리에 충실하면서, 환경과 기술에 종속되지 않고 필요에 따라 재활용될 수 있는 방식으로 설계된 오브젝트를 말한다

### POJO의 장점

* 특정 기술과 환경에 종속되지 않는 오브젝트는 그만큼 깔끔한 코드가 될 수 있다
* 자동화된 테스트에 매우 유리하다 - 환경의 제약이 없는 코드
* 객체 지향 설계를 자유롭게 적용할 수 있다

### POJO 프레임워크 

POJO 프로그래밍이 가능하도록 기술적인 기반을 제공하는 프레임워크를 POJO 프레임워크라고 한다

그 예

* 스프링 프레임워크
* 하이버네이트

## 8.4 스프링의 기술

### 제어의 역전(IoC) / 의존관계 주입(DI)

#### DI의 활용 방법

* 핵심기능의 변경
  * DI의 가장 대표적인 적용 방법 : 의존 대상의 구현을 바꾸는 것
  * A -> B 구조에서 B를 B1, B2, B3로 바꾸는 것
* 핵심기능의 동적인 변경
  * 의존 오브젝트의 핵심기능 자체를 바꾸는 것
  * DI를 잘 활용하면 애플리케이션이 동작하는 중간에 그 의존 대상을 다이내믹 하게 변경할 수 있음
* 부가기능의 추가
  * 핵심기능은 그대로 둔 채로 부가기능을 추가하는 것
  * 데코레이터 패턴
  * AOP
  * OCP 원칙에도 충실
* 인터페이스의 변경
  * 클라이언트가 사용하는 인터페이스와 실제 오브젝트 
    사이에 인터페이스가 일치하지 않는 경우에도 DI가 유용
  * 어댑터 패턴
  * PSA
* 프록시
  * 프록시 패턴 응용
* 템플릿과 콜백
* 싱글톤과 오브젝트 스코프
  * DI가 중요한 이유 중 하나는 DI할 오브젝트의 생명주기를 제어할 수 있다는 점이다
  * 오브젝트의 생성부터 관계설정, 이용, 소멸에 이르기까지의 모든 과정을 
    DI 컨테이너가 주관하기 때문에 그 오브젝트의 스코프를 자유롭게 제어할 수 있다
  * 기본 스코프는 싱글톤
* 테스트
  * 오브젝트를 효과적으로 테스트 하는 방법은 고립시키는 것이다

### 애스팩트 지향 프로그래밍 (AOP)

#### AOP의 적용 기법

1. 스프링과 같이 다이내믹 프록시를 사용하는 방법
   * 기존 코드에 영향을 주지 않고 부가기능을 적용하게 해주는 데코레이터 페턴을 응용한 것이다
   * 만들기 쉽고 적용하기 간편하다
   * 부가기능을 부여할 있는 곳은 메소드의 호출이 일어나는 지점 뿐이라는 제약이 있다
   * 스프링의 기본적인 AOP 구현 방법은 다이내믹 츠롤시를 이용하는 방식이다
2. 자바 언어의 한계를 넘어서는 언어의 확장을 이용하는 방법
   * AspectJ
   * AspectJ는 프록시 방식의 AOP에서는 불가능한 다양한 조인 포인트를 제공한다

#### AOP의 적용 단계

1. 미리 준비된 AOP 이용
   * 대표적인 예: 트랜잭션
   * @Configurable
     * AspectJ 필요
2. 전담팀을 통한 정책 AOP 적용
   * 개발 표준이나 가이드라인을 따라서 개발 및 적용
3. AOP의 자유로운 이용

### 포터블 서비스 추상화 (PSA)

> ###### 환경과 세부기술의 변화에 관계없이 일관된 방식으로 기술에 접근 할 수 있게 해준다

